</style><!DOCTYPE html>
<html lang="cs" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investiční kalkulačka – výpočet hodnoty investice v čase</title>
    
    <!-- Potřebné knihovny -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Chart.js & ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

    <!-- Konfigurace Tailwindu -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        slate: {
                            850: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        brand: {
                            dark: '#0a0f29',   // Hero pozadí
                            orange: '#ea8d00', // CTA, akcenty
                            gold: '#fbbf24',   // Jemné detaily
                            main: '#0B3A7A',   // Hlavní modrá (texty, ikony)
                            light: '#EAF3FF',  // Pozadí sekcí
                            border: '#D6E6FF', // Rámečky
                        }
                    },
                    keyframes: {
                        scroll: {
                            '0%': { transform: 'translateX(0)' },
                            '100%': { transform: 'translateX(-50%)' },
                        },
                        shimmer: {
                            '0%': { transform: 'skewX(-20deg) translateX(-150%)' },
                            '100%': { transform: 'skewX(-20deg) translateX(150%)' }
                        },
                        fadeIn: {
                            'from': { opacity: 0, transform: 'translateY(10px)' },
                            'to': { opacity: 1, transform: 'translateY(0)' }
                        }
                    },
                    animation: {
                        scroll: 'scroll 15s linear infinite',
                        shimmer: 'shimmer 2.5s infinite',
                        fadeIn: 'fadeIn 0.5s ease-out forwards',
                    }
                }
            }
        }
    </script>

    <style>
        /* Glass Effect Classes */
        .glass-header-top {
            background-color: #0a0f29;
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .glass-header-scrolled {
            background-color: rgba(255, 255, 255, 0.85); 
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid rgba(11, 58, 122, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.03);
        }

        /* Odkaz v menu */
        .nav-link {
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.02em;
            padding: 0.6rem 1rem;
            border-radius: 9999px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
        }

        /* --- STYLY PRO KALKULAČKU --- */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: #ea8d00;
            border: 3px solid #fff;
            cursor: pointer;
            margin-top: -10px;
            box-shadow: 0 4px 6px rgba(234, 141, 0, 0.4);
            transition: transform 0.1s;
        }
        input[type=range]::-webkit-slider-thumb:hover {
            transform: scale(1.1);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: #e2e8f0;
            border-radius: 3px;
        }
        input[type=range]:focus {
            outline: none;
        }
        
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        
        /* NOVÉ STYLY PRO LOGA PARTNERŮ */
/* OPRAVA VELIKOSTI LOG */
.partner-logo {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 120px !important; /* Větší prostor pro logo */
    margin: 15px !important;  /* Rozestupy mezi logy */
    min-width: 150px;         /* Minimální šířka, aby se nesmrsklo */
}

.partner-logo img {
    max-height: 80px !important; /* ZVĚTŠENÍ: Původně tam bylo asi 40-50px */
    max-width: 200px !important; /* Aby se vešla i dlouhá loga */
    width: auto;
    object-fit: contain;
    
    /* Vzhled */
    filter: grayscale(100%);
    opacity: 0.8;
    transition: all 0.3s ease;
}

.partner-logo img:hover {
    filter: grayscale(0%);
    opacity: 1;
    transform: scale(1.1); /* Efekt zvětšení po najetí */
}

/* ZAJIŠTĚNÍ ZALAMOVÁNÍ (Aby se loga netlačila v jedné řadě) */
/* 1. Definice pohybu */
@keyframes scroll {
    from { transform: translateX(0); }
    to { transform: translateX(-50%); }
/* 2. Nastavení pásu (VŠECHNA ZAŘÍZENÍ) */
.animate-scroll {
    /* TOTO JE NEJDŮLEŽITĚJŠÍ: Roztáhne pás tak, aby se vešla všechna loga vedle sebe */
    width: max-content !important; 
    display: flex !important;
    flex-wrap: nowrap !important; /* Zakáže zalamování na další řádek */
    
    /* Základní čas pro PC (větší číslo = pomalejší) */
    animation: scroll 40s linear infinite !important;
}

/* 3. Specifické nastavení pro MOBIL */
@media (max-width: 768px) {
    .animate-scroll {
        /* Čas pro mobil. */
        /* Zkus 20s. Díky 'max-content' to teď bude plynulé a rychlé tak akorát. */
        animation-duration: 20s !important; 
    }
    
    /* Zajištění, že loga nejsou nalepená na sobě */
    .partner-logo {
        margin: 0 15px !important;
    }
}    
        /* Custom FAQ Styles for expanding */
        .faq-answer-active {
            max-height: 500px !important;
            opacity: 1 !important;
        }
        
        /* Specific styling for the FAQ cards */
        .faq-card {
            border: 1px solid #D6E6FF; /* brand-border */
            background-color: #ffffff;
            transition: box-shadow 0.3s;
        }
        .faq-card:hover {
            box-shadow: 0 4px 12px rgba(11, 58, 122, 0.1);
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #0B3A7A; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #082855; }

        /* LOGO STYLY */
        .logo-img-style {
            width: 100%;
            height: 100%;
            object-fit: contain;
            /* Invert pro tmavé pozadí (TOP) */
            filter: invert(1);
            transition: filter 0.3s, transform 0.3s;
        }
        .glass-header-scrolled #logo-img-container .logo-img-style {
            /* Bez inverze pro světlé pozadí (SCROLLED) */
            filter: invert(0);
        }
        /* ============================================= */
/* VYNUCENÁ RYCHLOST JEN PRO MOBILY */
/* ============================================= */

        animation-duration: 8s !important; 
        
        /* Pojistka, aby animace vůbec běžela */
        animation-name: scroll !important;
        animation-timing-function: linear !important;
        animation-iteration-count: infinite !important;
    }
}
    </style>
</head>
<body class="bg-white font-sans text-slate-800 antialiased overflow-x-hidden">

    <!-- --- HEADER (ZAČÁTEK) --- -->
    <nav class="fixed w-full z-50 transition-all duration-500 glass-header-top" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center gap-4">
                
                <!-- Logo -->
                <div class="flex items-center gap-3 cursor-pointer shrink-0" onclick="window.location.href='/'">
                    <div id="logo-icon" class="bg-white text-brand-dark font-bold w-10 h-10 flex items-center justify-center rounded-full transition-all duration-300 shadow-sm overflow-hidden relative">
                        <!-- Logo obrázek s inverzním efektem -->
                        <div id="logo-img-container" class="w-full h-full p-2 flex items-center justify-center">
                            <img id="logo-img" src="logo_M_white.png" alt="Marek Marek Logo" class="logo-img-style" 
                                 onerror="this.style.display='none'; if(this.parentElement) this.parentElement.innerHTML='M';">
                        </div>
                    </div>
                    <div class="flex flex-col leading-tight">
                        <span id="logo-text" class="text-lg font-bold text-white transition-colors duration-300">Marek Marek<span class="text-brand-orange">.</span></span>
                        <span id="logo-subtext" class="text-[0.6rem] text-slate-300 font-bold tracking-widest uppercase transition-colors duration-300">Finanční partner</span>
                    </div>
                </div>
                
                <!-- Center Menu -->
                <div class="hidden lg:flex items-center justify-center flex-1 gap-1">
                    <a href="/#sluzby" class="nav-link text-white hover:bg-white/10 hover:backdrop-blur-md">Služby</a>
                    <div id="nav-divider" class="h-4 w-px bg-white/20 mx-2 transition-colors duration-300"></div>
                    <a href="/financni-plan/" class="nav-link text-white hover:bg-white/10 hover:backdrop-blur-md">Rodiny a jednotlivci</a>
                    <div id="nav-divider-2" class="h-4 w-px bg-white/20 mx-2 transition-colors duration-300"></div>
                    <a href="/podnikatele/" class="nav-link text-white hover:bg-white/10 hover:backdrop-blur-md">Podnikatelé a firmy</a>
                </div>

                <!-- Hamburger -->
                <div class="flex items-center">
                    <button id="mobile-menu-btn" class="text-brand-orange hover:text-brand-gold focus:outline-none p-2 transition-colors rounded-full hover:bg-white/10">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile/Drawer Menu Panel -->
        <div id="mobile-menu" class="hidden bg-white/95 backdrop-blur-xl border-t border-slate-100 absolute w-full shadow-2xl h-screen overflow-y-auto pb-20 z-40 top-[80px]">
            <div class="px-4 pt-6 space-y-4">
                <div>
                    <p class="px-4 text-xs font-bold text-slate-400 uppercase tracking-widest mb-3">Hlavní nabídka</p>
                    <div class="space-y-1">
                        <a href="/#sluzby" class="block px-4 py-3 text-lg font-bold text-slate-800 rounded-xl hover:bg-slate-50">Služby</a>
                        <a href="/financni-plan/" class="block px-4 py-3 text-lg font-bold text-slate-800 rounded-xl hover:bg-slate-50">Rodiny a jednotlivci</a>
                        <a href="/podnikatele/" class="block px-4 py-3 text-lg font-bold text-slate-800 rounded-xl hover:bg-slate-50">Podnikatelé a firmy</a>
                    </div>
                </div>
                
                <div>
                    <p class="px-4 text-xs font-bold text-slate-400 uppercase tracking-widest mb-3 mt-6">Nástroje</p>
                    <div class="space-y-2">
                        <a href="/hypotecnikalkulacka/" class="flex items-center px-4 py-3 text-brand-dark font-bold bg-white border border-slate-100 rounded-xl hover:bg-slate-50">
                            <i class="fas fa-calculator text-brand-orange mr-3"></i> Hypoteční kalkulačka
                        </a>
                        <a href="/investicnikalkulacka/" class="flex items-center px-4 py-3 text-brand-dark font-bold bg-brand-light/50 rounded-xl border border-brand-border/50">
                            <i class="fas fa-chart-line text-brand-main mr-3"></i> Investiční kalkulačka
                        </a>
                        <a href="/zivotnikalkulacka/" class="flex items-center px-4 py-3 text-brand-dark font-bold bg-white border border-slate-100 rounded-xl hover:bg-slate-50">
                            <i class="fas fa-heart-pulse text-red-500 mr-3"></i> Kalkulačka životního pojištění
                        </a>
                    </div>
                </div>
                
                <div class="pt-8 px-4">
                    <a href="/#kontakt" class="block w-full py-4 bg-brand-dark text-white text-center rounded-xl font-bold shadow-lg shadow-brand-dark/20">Kontaktovat</a>
                </div>
            </div>
        </div>
    </nav>
    <!-- --- HEADER (KONEC) --- -->

    <!-- === HLAVNÍ OBSAH KALKULAČKY (ZAČÁTEK) === -->
    <div class="pt-0">
        <section id="invest-kalkulacka" class="bg-brand-light py-10 px-4 md:py-20 lg:pt-32">
            <div class="max-w-7xl mx-auto">

                <!-- HLAVIČKA SEKCE -->
                <div class="bg-gradient-to-br from-brand-dark to-[#1e3a6e] rounded-3xl p-8 md:p-12 text-white mb-10 shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 right-0 w-96 h-96 bg-brand-orange opacity-10 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none"></div>
                    
                    <div class="relative z-10 flex flex-col lg:flex-row justify-between items-start gap-8">
                        <div class="flex-1">
                            <h1 class="text-3xl md:text-5xl font-extrabold mb-4 leading-tight">
                                Investiční kalkulačka – výpočet<br>
                                <span class="text-brand-orange">hodnoty investice v čase</span>
                            </h1>
                            <p class="text-blue-100 opacity-90 text-lg mb-8 max-w-2xl leading-relaxed">
                                Spočítejte si orientačně, jak se může vyvíjet vaše pravidelná investice v čase podle zvolené strategie. 
                                Výsledky slouží jako podklad pro další plánování.
                            </p>

                            <!-- Profile Switcher -->
                            <div class="flex flex-col gap-4">
                                <label class="text-xs font-bold text-blue-200 uppercase tracking-widest">Vyberte strategii</label>
                                <div class="inline-flex bg-slate-900/50 p-1.5 rounded-xl backdrop-blur-md border border-white/10 w-fit flex-wrap gap-1">
                                    <button class="profile-tab active px-5 py-3 rounded-lg text-sm font-bold transition-all duration-200 bg-brand-orange text-white shadow-lg flex items-center gap-2" data-profile="0" onclick="switchProfile(0)">
                                        <i class="fas fa-shield-alt"></i> Konzervativní
                                    </button>
                                    <button class="profile-tab px-5 py-3 rounded-lg text-sm font-bold transition-all duration-200 text-slate-300 hover:text-white hover:bg-white/10 flex items-center gap-2" data-profile="1" onclick="switchProfile(1)">
                                        <i class="fas fa-balance-scale"></i> Vyvážená
                                    </button>
                                    <button class="profile-tab px-5 py-3 rounded-lg text-sm font-bold transition-all duration-200 text-slate-300 hover:text-white hover:bg-white/10 flex items-center gap-2" data-profile="2" onclick="switchProfile(2)">
                                        <i class="fas fa-bolt"></i> Dynamická
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Badge -->
                        <div class="flex flex-col gap-3 min-w-[240px]">
                            <div class="bg-white rounded-xl py-4 px-6 shadow-lg flex flex-col items-center justify-center text-center gap-1">
                                <span class="text-xs font-bold text-slate-500 uppercase">Předpokládaný výnos</span>
                                <div class="flex items-baseline gap-1">
                                    <span id="headerRateDisplay" class="font-extrabold text-4xl text-brand-dark">7</span>
                                    <span class="font-bold text-xl text-brand-orange">% p.a.</span>
                                </div>
                                <span id="headerProfileName" class="text-xs font-medium text-slate-400">Vyvážený profil</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- INFO CARD -->
                <div class="mt-8 mb-10 max-w-7xl mx-auto px-4">
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
                        <h3 class="text-base font-bold text-[#0a0f29] mb-3 flex items-center gap-2">
                            <i class="fas fa-info-circle w-4 h-4 text-[#ea8d00]"></i>
                            Informace ke kalkulaci
                        </h3>
                        <div class="text-slate-600 space-y-2 leading-relaxed text-xs md:text-sm">
                            <p>
                                Tato kalkulačka slouží k orientačnímu výpočtu, jak se může vyvíjet hodnota vaší investice v čase při pravidelném investování.
                                Zohledňuje výši počátečního vkladu, měsíční investici, investiční horizont a zvolenou strategii.
                            </p>
                            <p>
                                Výsledkem je přehledná projekce budoucí hodnoty investice a celkového zhodnocení.
                                Kalkulačka pracuje s dlouhodobým pohledem a principem složeného úročení.
                            </p>
                            <p>
                                Výpočty jsou orientační a nezohledňují individuální daňové či legislativní aspekty.
                            </p>
                            <p>
                                Slouží jako podklad pro pochopení rozdílů mezi jednotlivými strategiemi a pro další rozhodování.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- SEKCE 1: VSTUPY A VÝSLEDKY (VEDLE SEBE) -->
                <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 items-start mt-10">

                    <!-- LEVÁ ČÁST: VSTUPY -->
                    <div class="lg:col-span-7 bg-white rounded-2xl p-6 md:p-8 shadow-sm border border-brand-border/60">
                        
                        <!-- 1. Počáteční vklad -->
                        <div class="mb-8">
                            <div class="flex justify-between items-end mb-4">
                                <label class="text-sm font-bold text-slate-600 tracking-wide">
                                    <span class="uppercase">Počáteční vklad</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>
                                </label>
                                <input type="text" id="initialDepositDisplay" class="text-right font-extrabold text-3xl text-brand-dark border-b-2 border-slate-200 focus:border-brand-orange outline-none w-56 bg-transparent transition-colors p-1" value="100 000">
                            </div>
                            <input type="range" id="initialRange" min="0" max="2000000" step="10000" value="100000" class="w-full">
                            <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                <span>0 Kč</span>
                                <span>2 mil.</span>
                            </div>
                        </div>

                        <!-- 2. Pravidelná měsíční investice -->
                        <div class="mb-8">
                            <div class="flex justify-between items-end mb-4">
                                <label class="text-sm font-bold text-slate-600 tracking-wide">
                                    <span class="uppercase">Měsíční investice</span> <span class="text-slate-400 font-normal normal-case">(v Kč)</span>
                                </label>
                                <input type="text" id="monthlyDepositDisplay" class="text-right font-extrabold text-3xl text-brand-dark border-b-2 border-slate-200 focus:border-brand-orange outline-none w-56 bg-transparent transition-colors p-1" value="5 000">
                            </div>
                            <input type="range" id="monthlyRange" min="500" max="50000" step="500" value="5000" class="w-full">
                            <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                <span>500 Kč</span>
                                <span>50 tis.</span>
                            </div>
                        </div>

                        <!-- 3. Doba investice -->
                        <div>
                            <label class="block text-sm font-bold text-slate-600 mb-4 uppercase tracking-wide">Doba investice</label>
                            <div class="flex items-center gap-4">
                                <input type="range" id="yearsRange" min="3" max="30" step="1" value="10" class="flex-1">
                                <div class="bg-slate-50 border border-slate-200 rounded-lg px-4 py-2 font-bold text-brand-dark min-w-[80px] text-center">
                                    <span id="yearsDisplay">10</span> let
                                </div>
                            </div>
                            <div class="flex justify-between text-xs font-medium text-slate-400 mt-2">
                                <span>3 roky</span>
                                <span>30 let</span>
                            </div>
                        </div>

                        <!-- Info Box -->
                        <div class="mt-8 bg-blue-50/50 border border-blue-100/50 rounded-xl p-4 flex items-start gap-3">
                            <i class="fas fa-info-circle text-brand-main mt-1"></i>
                            <div class="text-sm text-slate-600">
                                <strong class="block text-brand-dark mb-1" id="profileTitleDesc">Vyvážený investor</strong>
                                <span id="profileDesc">Zlatá střední cesta. Kombinace stability dluhopisů a růstového potenciálu akcií.</span>
                            </div>
                        </div>
                    </div>

                    <!-- PRAVÁ ČÁST: VÝSLEDKY -->
                    <div class="lg:col-span-5">
                        <div class="bg-brand-dark text-white rounded-2xl shadow-2xl shadow-brand-dark/30 border border-slate-800 p-8 overflow-hidden relative h-full flex flex-col justify-between">
                            <div class="absolute top-0 right-0 w-48 h-48 bg-brand-main opacity-20 rounded-full blur-2xl -mr-10 -mt-10"></div>
                            <div class="absolute bottom-0 left-0 w-32 h-32 bg-brand-orange opacity-10 rounded-full blur-xl -ml-10 -mb-10"></div>

                            <div>
                                <h3 class="text-slate-400 font-medium mb-2 relative z-10 text-sm uppercase tracking-wider">Předpokládaná hodnota</h3>
                                <div class="flex items-baseline gap-2 mb-6 relative z-10">
                                    <span id="totalBalance" class="text-4xl md:text-5xl font-black text-white tracking-tight">--</span>
                                    <span class="text-2xl font-medium text-slate-500">Kč</span>
                                </div>

                                <div class="space-y-0 relative z-10 bg-slate-800/50 rounded-xl p-1 backdrop-blur-sm border border-white/5">
                                    <div class="flex justify-between items-center p-4 border-b border-white/10">
                                        <span class="text-slate-300 text-sm">Váš vklad</span>
                                        <span class="font-bold text-white text-lg" id="totalInvested">-- Kč</span>
                                    </div>
                                    <div class="flex justify-between items-center p-4 border-b border-white/10">
                                        <span class="text-slate-300 text-sm">Zisk z investice</span>
                                        <span class="font-bold text-green-400 text-lg" id="totalGain">-- Kč</span>
                                    </div>
                                    <div class="flex justify-between items-center p-4">
                                        <span class="text-slate-300 text-sm">Zhodnocení</span>
                                        <span class="font-bold text-brand-gold text-lg" id="totalGainPercent">-- %</span>
                                    </div>
                                </div>
                                
                                <!-- Vysvětlující věta pod čísly -->
                                <p class="text-[11px] text-slate-400 mt-4 leading-normal opacity-70 relative z-10">
                                    Výsledky vycházejí z modelového výpočtu a slouží pro ilustraci dlouhodobého vývoje investice.
                                </p>
                            </div>

                            <div class="mt-8 relative z-10">
                                <button onclick="openModal()" class="group relative w-full bg-gradient-to-r from-brand-orange to-brand-gold hover:to-brand-orange text-brand-dark font-extrabold py-5 px-6 rounded-xl shadow-lg shadow-orange-500/20 transition-all transform hover:scale-[1.02] overflow-hidden">
                                    <div class="absolute top-0 left-0 w-full h-full bg-white/30 skew-x-[-20deg] animate-shimmer"></div>
                                    <div class="relative flex items-center justify-center gap-3">
                                        <span class="text-lg uppercase">Chci investiční plán</span>
                                        <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                                    </div>
                                </button>
                                <p class="text-xs text-slate-500 mt-4 text-center leading-relaxed opacity-60">
                                    Historické výnosy nejsou zárukou budoucích. Výpočty jsou orientační.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SEKCE 2: GRAFY PROJEKCE A SLOŽENÍ (VEDLE SEBE) -->
                <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-8">
                    
                    <!-- Graf 1: Projekce -->
                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-brand-border/60 flex flex-col text-center">
                        <h3 class="text-lg font-bold text-brand-dark flex items-center justify-center gap-2 mb-4">
                            <i class="fas fa-chart-line text-brand-orange"></i>
                            Projekce vývoje
                        </h3>
                        <div class="flex-1 min-h-[300px] chart-container">
                            <canvas id="growthChart"></canvas>
                        </div>
                        <!-- Vysvětlující věta pod grafem -->
                        <p class="text-xs text-slate-500 mt-4 italic">
                            Graf ukazuje odhadovaný vývoj hodnoty investice v čase při pravidelném investování a zvolené strategii.
                        </p>
                    </div>

                    <div class="bg-white rounded-2xl p-6 shadow-sm border border-brand-border/60 flex flex-col text-center">
                        <h3 class="text-lg font-bold text-brand-dark flex items-center justify-center gap-2 mb-4">
                            <i class="fas fa-chart-pie text-brand-orange"></i>
                            Složení portfolia
                        </h3>
                        <div class="flex-1 flex flex-col justify-center items-center gap-6">
                            <div class="relative h-56 w-56">
                                <canvas id="allocationChart"></canvas>
                            </div>
                            <div id="allocationLegend" class="w-full max-w-xs space-y-2">
                                <!-- JS injected legend -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- SEKCE 3: BACKTEST GRAF (FULL WIDTH) -->
                <div class="mt-12 bg-white rounded-3xl shadow-xl border border-slate-200 overflow-hidden">
                    <div class="p-6 md:p-10 border-b border-slate-100">
                        <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6 mb-4">
                            <div>
                                <h3 class="text-2xl md:text-3xl font-bold text-brand-dark flex items-center gap-3">
                                    <i class="fas fa-history text-brand-orange"></i>
                                    Simulace historického vývoje
                                </h3>
                                <p class="text-slate-600 mt-2 text-lg">
                                    Jak by dopadla vaše investice <span id="backtestMonthlyLabel" class="font-bold text-brand-main">-- Kč</span> měsíčně, kdybyste začali v roce <span id="startYearLabelDisplay" class="font-bold text-brand-main">--</span>?
                                </p>
                            </div>
                            <div class="flex items-center gap-2 text-xs font-bold uppercase tracking-wider bg-green-50 text-green-700 px-4 py-2 rounded-full border border-green-100">
                                <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                                Reálná tržní data 1995–2024
                            </div>
                        </div>
                        
                        <!-- Kontextová věta Backtest -->
                        <p class="text-sm text-slate-500 leading-relaxed max-w-3xl">
                            Historická simulace ukazuje, jak by se investice vyvíjela při zachování dlouhodobé strategie i v obdobích krizí a poklesů trhu.
                        </p>
                    </div>
                    
                    <div class="p-6 md:p-10">
                         <!-- Backtest Chart -->
                         <div id="backtestChart" class="w-full h-[500px]"></div>
                         
                         <!-- Year Slider Control -->
                         <div class="mt-10 bg-slate-50 rounded-2xl p-6 border border-slate-100">
                             <div class="flex justify-between items-center mb-4">
                                 <span class="text-sm font-bold text-slate-500 uppercase tracking-wider">Posunout v čase (Start investice)</span>
                                 <span class="text-lg font-bold text-brand-dark bg-white px-4 py-2 rounded-lg shadow-sm border border-slate-200" id="startYearDisplay">Rok 1995</span>
                             </div>
                             <input type="range" id="startYearInput" min="1995" max="2019" step="1" value="1995" class="w-full h-3 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                             <div class="flex justify-between text-xs font-bold text-slate-400 mt-3 uppercase tracking-wide">
                                 <span class="flex flex-col items-center gap-1"><i class="fas fa-caret-up text-lg"></i>1995 (Dot-com)</span>
                                 <span class="flex flex-col items-center gap-1"><i class="fas fa-caret-up text-lg"></i>2008 (Krize)</span>
                                 <span class="flex flex-col items-center gap-1"><i class="fas fa-caret-up text-lg"></i>2019 (Covid)</span>
                             </div>
                        </div>
                    </div>
                </div>
                
                <!-- SEKCE FAQ -->
                <div class="mt-12 lg:col-span-12">
                    <h2 class="text-3xl font-bold text-brand-dark mb-8 text-center uppercase tracking-widest">FAQ – Investiční kalkulačka</h2>
                    
                    <div id="faq-container" class="space-y-4 max-w-4xl mx-auto">
                        <!-- JS will render FAQ here -->
                    </div>
                </div>

                <!-- ZÁVĚREČNÁ CTA (INVESTIČNÍ PLÁN - Modrý box) -->
                <div class="mt-12 lg:col-span-12">
                    <div class="bg-gradient-to-r from-brand-dark to-[#1e3a6e] rounded-3xl p-8 md:p-12 text-white shadow-2xl relative overflow-hidden text-center">
                        <div class="absolute top-0 right-0 w-48 h-48 bg-brand-orange opacity-10 rounded-full blur-2xl -mr-10 -mt-10"></div>
                        <div class="absolute bottom-0 left-0 w-32 h-32 bg-brand-orange opacity-10 rounded-full blur-xl -ml-10 -mb-10"></div>

                        <h2 class="text-3xl font-extrabold text-white mb-4 relative z-10">Chcete investiční plán přizpůsobený vaší situaci?</h2>
                        <p class="text-lg text-blue-100 max-w-3xl mx-auto mb-8 relative z-10">
                            Výsledek z kalkulačky může sloužit jako základ pro sestavení konkrétní investiční strategie podle vašich cílů, příjmů a časového horizontu.
                        </p>
                        <!-- FIXED: Now triggers openModal() like the top CTA -->
                        <button onclick="openModal()" class="group relative inline-block w-full sm:w-auto bg-gradient-to-r from-brand-orange to-brand-gold hover:to-brand-orange text-brand-dark font-extrabold py-5 px-8 rounded-xl shadow-lg shadow-orange-500/20 transition-all transform hover:scale-[1.02] overflow-hidden no-underline text-center">
                            <div class="absolute top-0 left-0 w-full h-full bg-white/30 skew-x-[-20deg] animate-shimmer"></div>
                            <div class="relative flex items-center justify-center gap-3 text-lg uppercase tracking-wider">
                                Chci investiční plán
                                <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
                            </div>
                        </button>
                    </div>
                </div>

                <!-- DOPLŇKOVÁ CTA: SPOČÍTEJTE SI SAMI (2 SLOUPE) -->
                <div class="mt-12 lg:col-span-12 text-center">
                    <h2 class="text-2xl font-bold text-brand-dark mb-8 uppercase tracking-widest">Spočítejte si sami</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                        
                        <!-- 1. Životní pojištění kalkulačka -->
                        <a href="/zivotnikalkulacka/" class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 hover:shadow-lg transition-all group flex flex-col items-center text-center hover:border-red-400 no-underline">
                            <div class="w-16 h-16 bg-red-50 text-red-500 rounded-full flex items-center justify-center mb-4 group-hover:bg-red-100 transition-colors">
                                <i class="fas fa-heart-pulse text-3xl"></i>
                            </div>
                            <h4 class="text-lg font-bold text-slate-900 mb-2">Životní pojištění kalkulačka</h4>
                            <p class="text-slate-500 text-sm">Rychlý odhad potřebného pojistného krytí.</p>
                        </a>

                        <!-- 2. Hypotéky a úvěry -->
                        <a href="/hypotecnikalkulacka/" class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200 hover:shadow-lg transition-all group flex flex-col items-center text-center hover:border-brand-main no-underline">
                            <div class="w-16 h-16 bg-blue-50 text-brand-main rounded-full flex items-center justify-center mb-4 group-hover:bg-blue-100 transition-colors">
                                <i class="fas fa-home text-3xl"></i>
                            </div>
                            <h4 class="text-lg font-bold text-slate-900 mb-2">Hypotéky a úvěry</h4>
                            <p class="text-slate-500 text-sm">Financování bydlení a optimalizace závazků.</p>
                        </a>
                    </div>
                </div>

                <!-- PARTNEŘI / LOGA -->
<div class="mt-24 pt-10 border-t border-brand-border/50 overflow-hidden marquee-container relative opacity-80 hover:opacity-100 transition-opacity lg:col-span-12">
    <div class="flex whitespace-nowrap overflow-hidden py-4" style="height: 120px; align-items: center;"> 
        <div class="flex animate-scroll min-w-full items-center justify-around gap-12">
            
            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/creif-logo.png" alt="Creif" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/amundi-logo.png" alt="Amundi" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/edward-logo.png" alt="Edward" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/investika-logo.png" alt="Investika" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/avant-logo.png" alt="Avant" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/conseq-logo.png" alt="Conseq" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/cyrrus-logo.png" alt="Cyrrus" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/creif-logo.png" alt="Creif" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/amundi-logo.png" alt="Amundi" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/edward-logo.png" alt="Edward" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/investika-logo.png" alt="Investika" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/avant-logo.png" alt="Avant" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/conseq-logo.png" alt="Conseq" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

            <div class="partner-logo" style="min-width: 180px; display: flex; justify-content: center;">
                <img src="/images/cyrrus-logo.png" alt="Cyrrus" style="height: 70px !important; width: auto !important; max-width: 100%;">
            </div>

        </div>
    </div>
</div>
    <!-- === HLAVNÍ OBSAH KALKULAČKY (KONEC) === -->

    <!-- KONTAKTNÍ MODAL -->
    <div id="contactModal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-brand-dark/80 backdrop-blur-sm transition-opacity opacity-0" id="modalBackdrop"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4 pointer-events-none">
            <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md transform scale-95 opacity-0 transition-all duration-300 pointer-events-auto relative overflow-hidden" id="modalContent">
                <button onclick="closeModal()" class="absolute top-4 right-4 text-slate-400 hover:text-brand-dark transition-colors w-8 h-8 flex items-center justify-center rounded-full hover:bg-slate-100 z-10">
                    <i class="fas fa-times"></i>
                </button>
                <div class="bg-gradient-to-r from-slate-50 to-white px-8 py-8 border-b border-slate-100">
                    <h3 class="text-2xl font-bold text-brand-dark uppercase tracking-wide">Mám zájem o plán</h3>
                    <p class="text-sm text-slate-600 mt-2 flex items-center gap-2">
                        <i class="fas fa-chart-line text-brand-orange"></i>
                        <span>Strategie: <strong id="modalProfileName" class="text-brand-main">--</strong></span>
                    </p>
                </div>
                <div class="p-8">
                    <form action="https://formspree.io/f/xqezzzpe" method="POST" id="leadForm">
                        <input type="hidden" name="_subject" value="Poptávka: Investiční plán">
                        <div class="space-y-5">
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1 uppercase tracking-tighter">E-mail <span class="text-red-500">*</span></label>
                                <div class="relative">
                                    <i class="fas fa-envelope absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="email" name="email" required placeholder="vas@email.cz" class="w-full border border-slate-300 rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-brand-orange focus:border-transparent outline-none transition-shadow bg-slate-50 focus:bg-white">
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-bold text-slate-700 mb-1 uppercase tracking-tighter">Telefon <span class="text-slate-400 font-normal normal-case">(nepovinné)</span></label>
                                <div class="relative">
                                    <i class="fas fa-phone absolute left-4 top-3.5 text-slate-400"></i>
                                    <input type="tel" name="telefon" placeholder="+420 777 ..." class="w-full border border-slate-300 rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-brand-orange focus:border-transparent outline-none transition-shadow bg-slate-50 focus:bg-white">
                                </div>
                            </div>
                            <div class="flex items-start gap-3 mt-2 bg-blue-50/50 p-3 rounded-lg">
                                <input type="checkbox" id="consent" required class="mt-1 w-4 h-4 text-brand-orange rounded border-slate-300 focus:ring-brand-orange cursor-pointer">
                                <label for="consent" class="text-xs text-slate-600 cursor-pointer select-none">
                                    Souhlasím se zpracováním osobních údajů pro účely vytvoření investičního plánu.
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="w-full mt-8 bg-brand-dark hover:bg-slate-900 text-white font-bold py-4 rounded-xl shadow-lg shadow-brand-dark/20 transition-all transform active:scale-95 flex items-center justify-center gap-2 text-lg uppercase tracking-wider">
                            <span>Odeslat nezávazně</span>
                            <i class="fas fa-paper-plane text-sm"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- === FOOTER (ZAČÁTEK) === -->
    <footer class="bg-brand-dark text-slate-400 py-16 border-t border-white/10">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-4 gap-12 mb-12">
                <div class="col-span-1 md:col-span-1">
                    <div class="flex items-center gap-2 mb-4">
                        <div class="bg-white text-brand-dark font-bold w-8 h-8 flex items-center justify-center rounded">
                            <img src="logo_M_white.png" alt="Marek Marek Logo" class="w-full h-full object-contain p-1 invert">
                        </div>
                        <span class="text-xl font-bold text-white">Marek Marek.</span>
                    </div>
                    <p class="text-sm text-slate-400 mb-4">
                        Pomáhám klientům budovat a chránit majetek pomocí ověřených strategií.
                    </p>
                    <div class="flex space-x-4">
                        <a href="https://www.instagram.com/marekmarek_pfp/" class="text-slate-400 hover:text-white transition"><i class="fab fa-instagram text-xl"></i></a>
                        <a href="https://www.facebook.com/SMMarkx" class="text-slate-400 hover:text-white transition"><i class="fab fa-facebook text-xl"></i></a>
                        <a href="https://www.linkedin.com/in/marek-marek-489394226/" class="text-slate-400 hover:text-white transition"><i class="fab fa-linkedin text-xl"></i></a>
                        <a href="http://wa.me/420778511166" class="text-slate-400 hover:text-white transition"><i class="fab fa-whatsapp text-xl"></i></a>
                    </div>
                </div>

                <div>
                    <h4 class="text-white font-bold mb-4 uppercase text-xs tracking-widest">Menu</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="/#sluzby" class="hover:text-brand-orange transition">Služby</a></li>
                        <li><a href="/hypotecnikalkulacka/" class="hover:text-brand-orange transition">Hypoteční kalkulačka</a></li>
                        <li><a href="/investicnikalkulacka/" class="hover:text-brand-orange transition">Investiční kalkulačka</a></li>
                        <li><a href="/financni-plan/" class="hover:text-brand-orange transition">Rodiny a jednotlivci</a></li>
                        <li><a href="/podnikatele/" class="hover:text-brand-orange transition">Podnikatelé a firmy</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-white font-bold mb-4 uppercase text-xs tracking-widest">Kontakt</h4>
                    <ul class="space-y-3 text-sm">
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt mt-1 mr-3 text-brand-orange"></i>
                            <span>Jana z Dražic 99<br>Roudnice nad Labem</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone mr-3 text-brand-orange"></i>
                            <span>+420 778 511 166</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope mr-3 text-brand-orange"></i>
                            <a href="mailto:kontakt@marek-marek.cz">kontakt@marek-marek.cz</a>
                        </li>
                    </ul>
                </div>

                <div>
                    <h4 class="text-white font-bold mb-4 uppercase text-xs tracking-widest">Informace</h4>
                    <ul class="space-y-2 text-sm">
                        <li><a href="/gdpr/" class="hover:text-white transition">Ochrana osobních údajů</a></li>
                        <li><a href="/cookies/" class="hover:text-white transition">Cookies</a></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-white/10 pt-8 flex flex-col md:flex-row justify-between items-center text-xs text-slate-500">
                <p>&copy; 2025 Marek Marek. Všechna práva vyhrazena.</p>
            </div>
        </div>
    </footer>
    <!-- --- FOOTER (KONEC) --- -->

    <!-- JAVASCRIPT LOGIKA -->
    <script>
        // --- HEADER LOGIC (SCROLL EFFECT & MOBILE MENU) ---
        document.addEventListener('DOMContentLoaded', function() {
            const navbar = document.getElementById('navbar');
            const logoIcon = document.getElementById('logo-icon');
            const logoText = document.getElementById('logo-text');
            const logoSubtext = document.getElementById('logo-subtext');
            const navLinks = document.querySelectorAll('.nav-link');
            const dividers = document.querySelectorAll('[id^="nav-divider"]');
            const logoImg = document.getElementById('logo-img');
            const mobileBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');

            function updateHeader() {
                if (!navbar) return;

                if (window.scrollY > 20) {
                    navbar.classList.add('glass-header-scrolled');
                    navbar.classList.remove('glass-header-top');
                    
                    if(logoIcon) {
                        logoIcon.classList.remove('bg-white', 'text-brand-dark');
                        logoIcon.classList.add('bg-brand-dark', 'text-white');
                    }
                    if(logoImg) logoImg.classList.remove('invert');
                    if(logoText) {
                        logoText.classList.remove('text-white');
                        logoText.classList.add('text-brand-dark');
                    }
                    if(logoSubtext) {
                        logoSubtext.classList.remove('text-slate-300');
                        logoSubtext.classList.add('text-slate-500');
                    }
                    navLinks.forEach(link => {
                        link.classList.remove('text-white');
                        link.classList.add('text-brand-main');
                        link.classList.add('hover:bg-brand-light');
                        link.classList.remove('hover:bg-white/10');
                        link.classList.remove('hover:backdrop-blur-md');
                    });
                    dividers.forEach(div => {
                        div.classList.remove('bg-white/20');
                        div.classList.add('bg-brand-border');
                    });

                } else {
                    navbar.classList.remove('glass-header-scrolled');
                    navbar.classList.add('glass-header-top');

                    if(logoIcon) {
                        logoIcon.classList.add('bg-white', 'text-brand-dark');
                        logoIcon.classList.remove('bg-brand-dark', 'text-white');
                    }
                    if(logoImg) logoImg.classList.add('invert');
                    if(logoText) {
                        logoText.classList.add('text-white');
                        logoText.classList.remove('text-brand-dark');
                    }
                    if(logoSubtext) {
                        logoSubtext.classList.add('text-slate-300');
                        logoSubtext.classList.remove('text-slate-500');
                    }
                    navLinks.forEach(link => {
                        link.classList.add('text-white');
                        link.classList.remove('text-brand-main');
                        link.classList.remove('hover:bg-brand-light');
                        link.classList.add('hover:bg-white/10');
                        link.classList.add('hover:backdrop-blur-md');
                    });
                    dividers.forEach(div => {
                        div.classList.add('bg-white/20');
                        div.classList.remove('bg-brand-border');
                    });
                }
            }

            window.addEventListener('scroll', updateHeader);
            updateHeader();

            if (mobileBtn && mobileMenu) {
                mobileBtn.addEventListener('click', () => { 
                    mobileMenu.classList.toggle('hidden'); 
                });
            }
        });

        // --- CALCULATOR LOGIC (KEEP UNTOUCHED) ---
        const profiles = [
            {
                id: 'konzervativni',
                name: 'Konzervativní investor',
                rate: 5,
                color: '#3b82f6', 
                description: 'Stabilní zhodnocení s minimálním kolísáním. Ideální pro opatrné investory. Využívá dluhopisy a nemovitostní fondy.',
                composition: [
                    { name: 'Dluhopisy', value: 70, color: '#3b82f6' },
                    { name: 'Nemovitostní fondy', value: 20, color: '#10b981' },
                    { name: 'Akcie', value: 10, color: '#f59e0b' },
                ]
            },
            {
                id: 'vyvazeny',
                name: 'Vyvážený investor',
                rate: 7,
                color: '#a855f7', 
                description: 'Zlatá střední cesta. Kombinace stability dluhopisů, růstového potenciálu akcií a jistoty nemovitostních fondů.',
                composition: [
                    { name: 'Akcie (ETF)', value: 50, color: '#f59e0b' },
                    { name: 'Dluhopisy', value: 35, color: '#3b82f6' },
                    { name: 'Nemovitostní fondy', value: 15, color: '#10b981' },
                ]
            },
            {
                id: 'dynamicky',
                name: 'Dynamický investor',
                rate: 9,
                color: '#eab308', 
                description: 'Maximální potenciál výnosu. Strategie pro dlouhodobé cíle.',
                composition: [
                    { name: 'Globální Akcie', value: 90, color: '#f59e0b' },
                    { name: 'Dluhopisy', value: 10, color: '#3b82f6' },
                ]
            }
        ];

        const historicalData = [
          { date: '1995-01', sp500: 459, gold: 380, bonds: 100, re: 100 },
          { date: '1996-06', sp500: 670, gold: 385, bonds: 108, re: 106 },
          { date: '1998-01', sp500: 970, gold: 290, bonds: 115, re: 112 },
          { date: '1999-12', sp500: 1469, gold: 290, bonds: 118, re: 120 },
          { date: '2001-09', sp500: 1040, gold: 290, bonds: 125, re: 128 },
          { date: '2002-10', sp500: 776, gold: 315, bonds: 135, re: 132 },
          { date: '2004-01', sp500: 1130, gold: 410, bonds: 138, re: 140 },
          { date: '2007-10', sp500: 1565, gold: 750, bonds: 145, re: 155 },
          { date: '2008-09', sp500: 1100, gold: 830, bonds: 148, re: 158 },
          { date: '2009-03', sp500: 676, gold: 920, bonds: 152, re: 156 },
          { date: '2010-06', sp500: 1030, gold: 1240, bonds: 158, re: 162 },
          { date: '2011-08', sp500: 1120, gold: 1820, bonds: 165, re: 168 },
          { date: '2013-01', sp500: 1498, gold: 1660, bonds: 170, re: 175 },
          { date: '2015-01', sp500: 2000, gold: 1280, bonds: 175, re: 185 },
          { date: '2018-09', sp500: 2900, gold: 1200, bonds: 178, re: 205 },
          { date: '2020-02', sp500: 3380, gold: 1550, bonds: 185, re: 215 },
          { date: '2020-03', sp500: 2300, gold: 1470, bonds: 180, re: 214 },
          { date: '2020-08', sp500: 3500, gold: 2060, bonds: 190, re: 218 },
          { date: '2021-12', sp500: 4766, gold: 1800, bonds: 185, re: 225 },
          { date: '2022-06', sp500: 3785, gold: 1810, bonds: 165, re: 228 },
          { date: '2022-10', sp500: 3580, gold: 1650, bonds: 155, re: 230 },
          { date: '2023-12', sp500: 4700, gold: 2040, bonds: 162, re: 245 },
          { date: '2024-04', sp500: 5200, gold: 2350, bonds: 164, re: 250 }
        ];

        let state = { initial: 100000, monthly: 5000, years: 10, profileIndex: 1, startYear: 1995 };
        let growthChartInstance = null, allocationChartInstance = null, backtestChartInstance = null, openFaq = null;

        const faqData = [
            { question: "Co je investiční kalkulačka a k čemu slouží?", answer: "Kalkulačka slouží k rychlému a orientačnímu výpočtu potenciální budoucí hodnoty vaší pravidelné investice na základě vámi zvolené strategie a investičního horizontu." },
            { question: "Jak investiční kalkulačka počítá výnosy?", answer: "Kalkulačka používá princip složeného úročení na základě průměrné roční výnosnosti (p.a.) při pravidelném měsíčním vkladu po celou dobu trvání investice." },
            { question: "Jsou uvedené výnosy garantované?", answer: "Nejsou. Výsledky jsou pouze orientační projekce založené na historických průměrech. Investování s sebou nese riziko, a minulé výnosy nezaručují výnosy budoucí." },
            { question: "Jaký je rozdíl mezi konzervativní, vyváženou a dynamickou strategií?", answer: "Konzervativní strategie preferuje stabilitu s nižším očekávaným výnosem. Dynamická strategie upřednostňuje růst s vyšším potenciálem, ale i vyšším rizikem kolísání." },
            { question: "Je kalkulačka vhodná pro dlouhodobé investování?", answer: "Ano, výpočty modelují dlouhé časové horizonty (3–30 let), což je v souladu s doporučeními pro efektivní investování do diverzifikovaných portfolií." },
            { question: "Mohu výsledek konzultovat s Vámi?", answer: "Určitě. Výsledek kalkulačky je ideálním výchozím bodem pro individuální konzultaci. Můžete si sjednat schůzku a probrat své konkrétní finanční cíle a rizika." }
        ];

        function getEls() {
            return {
                initialRange: document.getElementById('initialRange'), initialInput: document.getElementById('initialDepositDisplay'),
                monthlyRange: document.getElementById('monthlyRange'), monthlyInput: document.getElementById('monthlyDepositDisplay'),
                yearsRange: document.getElementById('yearsRange'), yearsDisplay: document.getElementById('yearsDisplay'),
                totalBalance: document.getElementById('totalBalance'), totalInvested: document.getElementById('totalInvested'),
                totalGain: document.getElementById('totalGain'), totalGainPercent: document.getElementById('totalGainPercent'),
                headerRate: document.getElementById('headerRateDisplay'), headerProfile: document.getElementById('headerProfileName'),
                profileTitleDesc: document.getElementById('profileTitleDesc'), profileDesc: document.getElementById('profileDesc'),
                allocationLegend: document.getElementById('allocationLegend'), backtestMonthlyLabel: document.getElementById('backtestMonthlyLabel'),
                startYearInput: document.getElementById('startYearInput'), startYearDisplay: document.getElementById('startYearDisplay'),
                startYearLabelDisplay: document.getElementById('startYearLabelDisplay'), faqContainer: document.getElementById('faq-container'),
                tabs: document.querySelectorAll('.profile-tab'), growthCanvas: document.getElementById('growthChart'),
                allocationCanvas: document.getElementById('allocationChart'), modal: document.getElementById('contactModal'),
                modalBackdrop: document.getElementById('modalBackdrop'), modalContent: document.getElementById('modalContent'),
                modalProfileName: document.getElementById('modalProfileName'),
            };
        }

        const formatCurrency = (num) => num.toFixed(0).toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        const parseCurrency = (str) => parseInt(str.replace(/\s/g, ''), 10) || 0;
        const CZECH_MONTHS = ['Leden', 'Únor', 'Březen', 'Duben', 'Květen', 'Červen', 'Červenec', 'Srpen', 'Září', 'Říjen', 'Listopad', 'Prosinec'];

        function renderFaq() {
            const els = getEls();
            if (!els.faqContainer) return;
            els.faqContainer.innerHTML = faqData.map((item, index) => `
                <div class="faq-card rounded-xl shadow-sm mb-4 border border-slate-100">
                    <button class="w-full text-left py-4 px-6 flex justify-between items-center transition-colors hover:text-brand-orange focus:outline-none" onclick="toggleFaq(${index})">
                        <h4 class="text-lg font-bold text-slate-900">${item.question}</h4>
                        <i id="faq-icon-${index}" class="fas fa-chevron-down text-sm transition-transform text-brand-main shrink-0 ml-4"></i>
                    </button>
                    <div id="faq-answer-${index}" class="pb-4 px-6 overflow-hidden transition-all duration-300 ease-in-out" style="max-height: 0; opacity: 0;">
                        <p class="text-slate-600 text-sm">${item.answer}</p>
                    </div>
                </div>`).join('');
        }

        function toggleFaq(index) {
            const newOpenFaq = openFaq === index ? null : index;
            if (openFaq !== null && openFaq !== index) {
                const prevAnswer = document.getElementById(`faq-answer-${openFaq}`);
                const prevIcon = document.getElementById(`faq-icon-${openFaq}`);
                if (prevAnswer) { prevAnswer.style.maxHeight = '0'; prevAnswer.style.opacity = '0'; }
                if (prevIcon) { prevIcon.classList.remove('rotate-180', 'text-brand-orange'); prevIcon.classList.add('text-brand-main'); }
            }
            openFaq = newOpenFaq;
            if (openFaq !== null) {
                const currentAnswer = document.getElementById(`faq-answer-${openFaq}`);
                const currentIcon = document.getElementById(`faq-icon-${openFaq}`);
                if (currentAnswer) { currentAnswer.style.maxHeight = currentAnswer.scrollHeight + 50 + 'px'; currentAnswer.style.opacity = '1'; }
                if (currentIcon) { currentIcon.classList.add('rotate-180', 'text-brand-orange'); currentIcon.classList.remove('text-brand-main'); }
            }
        }

        function switchProfile(index) {
            state.profileIndex = index;
            const els = getEls();
            els.tabs.forEach(t => {
                if(parseInt(t.dataset.profile) === index) {
                    t.classList.add('bg-brand-orange', 'text-white', 'shadow-lg');
                    t.classList.remove('text-slate-300', 'hover:text-white', 'hover:bg-white/10');
                } else {
                    t.classList.remove('bg-brand-orange', 'text-white', 'shadow-lg');
                    t.classList.add('text-slate-300', 'hover:text-white', 'hover:bg-white/10');
                }
            });
            const p = profiles[index];
            els.headerRate.innerText = p.rate;
            els.headerProfile.innerText = p.name;
            els.profileTitleDesc.innerText = p.name;
            els.profileDesc.innerText = p.description;
            calculate();
        }

        function updateInputs(key, value) {
            state[key] = value;
            const els = getEls();
            if (key === 'initial') { els.initialInput.value = formatCurrency(state.initial); els.initialRange.value = state.initial; }
            else if (key === 'monthly') { els.monthlyInput.value = formatCurrency(state.monthly); els.monthlyRange.value = state.monthly; }
            else if (key === 'years') { els.yearsDisplay.innerText = state.years; }
            else if (key === 'startYear') { els.startYearDisplay.innerText = 'Rok ' + state.startYear; if(els.startYearLabelDisplay) els.startYearLabelDisplay.innerText = state.startYear; }
            calculate();
        }

        function calculate() {
            const els = getEls();
            const profile = profiles[state.profileIndex];
            let currentBalance = state.initial, totalInvested = state.initial;
            const labels = [], dataBalance = [], dataInvested = [];
            labels.push('Start'); dataBalance.push(currentBalance); dataInvested.push(totalInvested);
            for (let i = 1; i <= state.years; i++) {
                for (let m = 0; m < 12; m++) {
                    currentBalance += currentBalance * (profile.rate / 100 / 12) + state.monthly;
                    totalInvested += state.monthly;
                }
                labels.push(`${i}. rok`); dataBalance.push(Math.round(currentBalance)); dataInvested.push(Math.round(totalInvested));
            }
            els.totalBalance.innerText = formatCurrency(Math.round(currentBalance));
            els.totalInvested.innerText = formatCurrency(Math.round(totalInvested)) + " Kč";
            els.totalGain.innerText = "+" + formatCurrency(Math.round(currentBalance - totalInvested)) + " Kč";
            els.totalGainPercent.innerText = "+" + (((currentBalance - totalInvested) / totalInvested) * 100).toFixed(1) + " %";
            updateGrowthChart(labels, dataInvested, dataBalance, profile.color);
            updateAllocationChart(profile);
            updateBacktestChart();
        }

        function updateGrowthChart(labels, invested, balance, color) {
            const ctx = getEls().growthCanvas.getContext('2d');
            if (growthChartInstance) growthChartInstance.destroy();
            const gradient = ctx.createLinearGradient(0, 0, 0, 300);
            gradient.addColorStop(0, color + '66');
            gradient.addColorStop(1, color + '00');
            growthChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Celková hodnota', data: balance, borderColor: color, backgroundColor: gradient, borderWidth: 3, fill: true, tension: 0.4, pointRadius: 0, pointHoverRadius: 6 },
                        { label: 'Váš vklad', data: invested, borderColor: '#cbd5e1', borderWidth: 2, borderDash: [5, 5], fill: false, tension: 0.4, pointRadius: 0, pointHoverRadius: 6 }
                    ]
                },
                options: { responsive: true, maintainAspectRatio: false, interaction: { mode: 'index', intersect: false }, plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => (c.dataset.label + ': ' + new Intl.NumberFormat('cs-CZ').format(c.parsed.y) + ' Kč') } } }, scales: { y: { beginAtZero: false, grid: { color: '#f1f5f9' }, ticks: { callback: (v) => v >= 1000000 ? (v/1000000).toFixed(1) + 'M' : (v/1000).toFixed(0) + 'k' } }, x: { grid: { display: false }, ticks: { maxTicksLimit: 6 } } } }
            });
        }

        function updateAllocationChart(profile) {
            const els = getEls();
            els.allocationLegend.innerHTML = profile.composition.map(item => `
                <div class="flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 transition-colors">
                    <div class="flex items-center gap-3">
                        <span class="w-3 h-3 rounded-full shadow-sm" style="background-color: ${item.color}"></span>
                        <span class="font-bold text-slate-700 text-sm">${item.name}</span>
                    </div>
                    <span class="font-bold text-brand-dark">${item.value} %</span>
                </div>`).join('');
            const ctx = els.allocationCanvas.getContext('2d');
            if (allocationChartInstance) allocationChartInstance.destroy();
            allocationChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: profile.composition.map(c => c.name), datasets: [{ data: profile.composition.map(c => c.value), backgroundColor: profile.composition.map(c => c.color), borderWidth: 0, hoverOffset: 4 }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '70%', plugins: { legend: { display: false }, tooltip: { callbacks: { label: (c) => ` ${c.label}: ${c.parsed}%` } } } }
            });
        }

        function updateBacktestChart() {
            const monthly = state.monthly, startYear = state.startYear, els = getEls();
            if(els.backtestMonthlyLabel) els.backtestMonthlyLabel.innerText = formatCurrency(monthly);
            const targetStartDate = new Date(`${startYear}-01-01`);
            let startIndex = historicalData.findIndex(d => new Date(d.date) >= targetStartDate);
            if (startIndex === -1) startIndex = 0;
            let accInvested = 0, units = { sp500: 0, gold: 0, bonds: 0, re: 0 };
            const series = { invested: [], sp500: [], gold: [], bonds: [], re: [] };
            const getMonthsDiff = (d1, d2) => { let m = (d2.getFullYear() - d1.getFullYear()) * 12; m -= d1.getMonth(); m += d2.getMonth(); return m <= 0 ? 0 : m; };
            for (let i = startIndex; i < historicalData.length; i++) {
                const pt = historicalData[i], currentDate = new Date(pt.date);
                let monthsPassed = i > startIndex ? getMonthsDiff(new Date(historicalData[i-1].date), currentDate) : 1;
                if (monthsPassed < 1) monthsPassed = 1;
                const deposit = monthly * monthsPassed;
                accInvested += deposit;
                units.sp500 += deposit / pt.sp500; units.gold += deposit / pt.gold;
                units.bonds += deposit / pt.bonds; units.re += deposit / pt.re;
                const ts = currentDate.getTime();
                series.invested.push([ts, accInvested]);
                series.sp500.push([ts, Math.round(units.sp500 * pt.sp500)]);
                series.gold.push([ts, Math.round(units.gold * pt.gold)]);
                series.bonds.push([ts, Math.round(units.bonds * pt.bonds)]);
                series.re.push([ts, Math.round(units.re * pt.re)]);
            }
            const options = {
                series: [{ name: 'Vloženo celkem', type: 'area', data: series.invested }, { name: 'S&P 500', type: 'area', data: series.sp500 }, { name: 'Zlato', type: 'line', data: series.gold }, { name: 'Dluhopisy', type: 'line', data: series.bonds }, { name: 'Nemovitostní fondy', type: 'line', data: series.re }],
                chart: { type: 'area', height: 500, fontFamily: 'Inter, sans-serif', toolbar: { show: false }, zoom: { enabled: false }, animations: { enabled: false } },
                colors: ['#E0E0E0', '#2E3A8C', '#F2C94C', '#775DD0', '#00E396'],
                stroke: { curve: 'smooth', width: [0, 2, 2, 2, 2] },
                fill: { type: ['solid', 'gradient', 'solid', 'solid', 'solid'], gradient: { shadeIntensity: 1, opacityFrom: 0.4, opacityTo: 0.05, stops: [0, 100] }, opacity: [0.3, 0.5, 1, 1, 1] },
                dataLabels: { enabled: false }, grid: { borderColor: '#f1f5f9', strokeDashArray: 3, xaxis: { lines: { show: true } } },
                xaxis: { type: 'datetime', tooltip: { enabled: false }, axisBorder: { show: false }, axisTicks: { show: false }, labels: { style: { colors: '#94a3b8' } } },
                yaxis: { labels: { formatter: (val) => val >= 1000000 ? (val / 1000000).toFixed(1) + "M" : (val >= 1000 ? (val / 1000).toFixed(0) + "k" : val), style: { colors: '#94a3b8' } } },
                tooltip: { theme: 'light', shared: true, intersect: false, y: { formatter: (val) => formatCurrency(val) }, x: { formatter: (val) => { const date = new Date(val); return `${CZECH_MONTHS[date.getMonth()]} ${date.getFullYear()}`; } } },
                legend: { position: 'top', horizontalAlign: 'right' }, markers: { size: 0 },
                annotations: { xaxis: [{ x: new Date('2000-03-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'Dot-com', style: { color: '#fff', background: '#EF4444' } } }, { x: new Date('2008-09-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'Krize 2008', style: { color: '#fff', background: '#EF4444' } } }, { x: new Date('2020-03-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'COVID-19', style: { color: '#fff', background: '#EF4444' } } }, { x: new Date('2022-02-01').getTime(), borderColor: '#EF4444', strokeDashArray: 2, label: { text: 'Válka/Inflace', style: { color: '#fff', background: '#EF4444' } } }] }
            };
            if (backtestChartInstance) { backtestChartInstance.updateOptions({ series: options.series }); }
            else { const chartDiv = document.querySelector("#backtestChart"); if(chartDiv) { backtestChartInstance = new ApexCharts(chartDiv, options); backtestChartInstance.render(); } }
        }

        function openModal() { const els = getEls(); els.modalProfileName.innerText = profiles[state.profileIndex].name; els.modal.classList.remove('hidden'); setTimeout(() => { els.modalBackdrop.classList.remove('opacity-0'); els.modalContent.classList.remove('opacity-0', 'scale-95'); els.modalContent.classList.add('scale-100'); }, 10); }
        function closeModal() { const els = getEls(); els.modalBackdrop.classList.add('opacity-0'); els.modalContent.classList.remove('scale-100'); els.modalContent.classList.add('opacity-0', 'scale-95'); setTimeout(() => els.modal.classList.add('hidden'), 300); }

        document.addEventListener('DOMContentLoaded', () => {
            const els = getEls();
            els.initialRange.addEventListener('input', (e) => updateInputs('initial', parseInt(e.target.value)));
            els.initialInput.addEventListener('change', (e) => updateInputs('initial', parseCurrency(e.target.value)));
            els.monthlyRange.addEventListener('input', (e) => updateInputs('monthly', parseInt(e.target.value)));
            els.monthlyInput.addEventListener('change', (e) => updateInputs('monthly', parseCurrency(e.target.value)));
            els.yearsRange.addEventListener('input', (e) => updateInputs('years', parseInt(e.target.value)));
            els.startYearInput.addEventListener('input', (e) => updateInputs('startYear', parseInt(e.target.value)));
            renderFaq(); switchProfile(1);
        });
    </script>
</body>
</html>
